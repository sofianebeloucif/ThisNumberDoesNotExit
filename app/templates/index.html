<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="app-title">ThisNumberDoesNotExist</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;700&display=swap"
          rel="stylesheet">

    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body
        data-has-global="{{ has_global | lower }}"
        data-has-conditional="{{ has_conditional | lower }}">

<div class="container">
    <div class="sidebar">
        <div class="header">
            <div class="lang-selector">
                <button id="lang-en" class="lang-btn active" onclick="setLang('en')">EN</button>
                <button id="lang-fr" class="lang-btn" onclick="setLang('fr')">FR</button>
            </div>
            <h1 id="header-title">ThisNumberDoesNotExist<span style="color: var(--text-muted)">.v3</span></h1>
            <p id="header-subtitle">Handwritting number generation using <br>Kernel density estimation</p>
        </div>

        <div class="card">
            <h2 id="h2-config">Configuration</h2>

            <label id="lbl-mode">GENERATION MODE</label>
            <div class="mode-grid">
                <div class="mode-btn" data-mode="global" id="btn-mode-global"
                     onclick="setMode('global')">
                    <span class="mode-icon">⛭</span>
                    <span class="mode-label" id="mode-global-label">GLOBAL</span>
                </div>

                <div class="mode-btn" data-mode="conditional" id="btn-mode-conditional"
                     onclick="setMode('conditional')">
                    <span class="mode-icon">★</span>
                    <span class="mode-label" id="mode-conditional-label">CONDITIONAL</span>
                </div>
            </div>

            <div id="digit-wrapper" class="control-group hidden-section">
                <label id="lbl-digit">DIGIT SELECTION</label>
                <div class="digit-grid">
                    <div class="digit-btn active" onclick="setDigit(0, this)">0</div>
                    <div class="digit-btn" onclick="setDigit(1, this)">1</div>
                    <div class="digit-btn" onclick="setDigit(2, this)">2</div>
                    <div class="digit-btn" onclick="setDigit(3, this)">3</div>
                    <div class="digit-btn" onclick="setDigit(4, this)">4</div>
                    <div class="digit-btn" onclick="setDigit(5, this)">5</div>
                    <div class="digit-btn" onclick="setDigit(6, this)">6</div>
                    <div class="digit-btn" onclick="setDigit(7, this)">7</div>
                    <div class="digit-btn" onclick="setDigit(8, this)">8</div>
                    <div class="digit-btn" onclick="setDigit(9, this)">9</div>
                </div>
            </div>

            <div class="control-group">
                <div style="display:flex;justify-content:space-between;margin-bottom:8px;">
                    <label id="lbl-batch" style="margin:0">BATCH SIZE</label>
                    <span id="lbl-samples"
                          style="font-weight:bold;color:var(--accent);">4</span>
                </div>
                <input type="range" id="inp-samples" min="1" max="16" value="4">
            </div>

            <div class="control-group">
                <label id="lbl-filter">FILTERING</label>

                <label class="toggle-row" onclick="toggleCleaningOptions(event)">
                    <span id="lbl-cleaning">Image Cleaning (Binarization)</span>
                    <input type="checkbox" id="inp-cleaning" checked
                           onchange="toggleCleaningOptions(event, true)">
                </label>

                <div class="control-group" id="cleaning-options" style="padding:0 0 1rem;">
                    <label id="lbl-cleaning-level">
                        CLEANING LEVEL
                        <span class="tooltip-container">
                            <span class="tooltip-icon">[?]</span>
                            <span class="tooltip-text" id="tooltip-cleaning"></span>
                        </span>
                    </label>

                    <div class="percentile-select">
                        <!-- Fallback text included -->
                        <button class="cleaning-btn"
                                data-method="light"
                                onclick="setCleaningLevel('light', this)">Light</button>

                        <button class="cleaning-btn active"
                                data-method="medium"
                                onclick="setCleaningLevel('medium', this)">Medium</button>

                        <button class="cleaning-btn"
                                data-method="aggressive"
                                onclick="setCleaningLevel('aggressive', this)">Aggressive</button>
                    </div>
                </div>

                <label class="toggle-row" onclick="toggleRejectionOptions(event)">
                    <span id="lbl-rejection">Rejection Sampling</span>
                    <input type="checkbox" id="inp-rejection" checked
                           onchange="toggleRejectionOptions(event, true)">
                </label>
            </div>

            <div class="control-group" id="percentile-group">
                <label id="lbl-quality">
                    QUALITY THRESHOLD
                    <span class="tooltip-container">
                        <span class="tooltip-icon">[?]</span>
                        <span class="tooltip-text" id="tooltip-quality"></span>
                    </span>
                </label>

                <div class="percentile-select">
                    <button class="p-btn" onclick="setPercentile(10)">10%</button>
                    <button class="p-btn active" onclick="setPercentile(25)">25%</button>
                    <button class="p-btn" onclick="setPercentile(50)">50%</button>
                </div>
            </div>

            <button class="btn-gen" id="btn-generate"
                    onclick="generateImages()">
                INITIALIZE SEQUENCE
            </button>

            <div id="error-display" class="error-box"></div>
        </div>
    </div>

    <div class="gallery-area">
        <div class="results-meta">
            <span id="status-text">System ready.</span>
            <span id="info-tag">MODE: GLOBAL</span>
        </div>

        <div class="gallery-grid" id="gallery">
            <div style="grid-column:1/-1;height:300px;display:flex;
                        align-items:center;justify-content:center;
                        border:1px dashed var(--border);border-radius:var(--radius);">
                <span id="gallery-placeholder">NO DATA GENERATED</span>
            </div>
        </div>
    </div>
</div>

<script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>
